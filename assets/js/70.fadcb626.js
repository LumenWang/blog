(window.webpackJsonp=window.webpackJsonp||[]).push([[70],{467:function(t,s,e){"use strict";e.r(s);var a=e(2),r=Object(a.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("blockquote",[e("p",[t._v("写在前面：时隔两天，终于成功编译tensorflow的c++接口。熟悉了cmake的使用方法，接触了powershell，chocolatey，bazel，tensorflow的各个版本源代码，swigwin-3.0.12，收获很大。这里面最大的坑就是tensorflow和编译工具的版本匹配问题，有的时候很多问题原本简单，版本不匹配就会出现很多莫名其妙的问题。")])]),t._v(" "),e("h3",{attrs:{id:"_1-准备工作"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-准备工作"}},[t._v("#")]),t._v(" 1.准备工作")]),t._v(" "),e("ul",[e("li",[t._v("tensorflow源代码 "),e("a",{attrs:{href:"https://github.com/tensorflow/tensorflow/releases",target:"_blank",rel:"noopener noreferrer"}},[t._v("github网址"),e("OutboundLink")],1)]),t._v(" "),e("li",[t._v("cmake "),e("a",{attrs:{href:"https://download.csdn.net/download/weixin_40937100/11046661",target:"_blank",rel:"noopener noreferrer"}},[t._v("下载地址"),e("OutboundLink")],1)]),t._v(" "),e("li",[t._v("swigwin-3.0.12 "),e("a",{attrs:{href:"https://download.csdn.net/download/weixin_40937100/11046664",target:"_blank",rel:"noopener noreferrer"}},[t._v("下载地址"),e("OutboundLink")],1)]),t._v(" "),e("li",[t._v("Git "),e("a",{attrs:{href:"https://download.csdn.net/download/weixin_40937100/11046664",target:"_blank",rel:"noopener noreferrer"}},[t._v("下载地址"),e("OutboundLink")],1)]),t._v(" "),e("li",[t._v("visual studio 2015 "),e("a",{attrs:{href:"https://visualstudio.microsoft.com/zh-hans/?rr=https%3A%2F%2Fwww.baidu.com%2Flink%3Furl%3DkL6BcURwPogNMdc68I92BNDRuSaB3jvTq_ggEWlkSBCm6_7ADE24_zLXwmOmBFMm%26wd%3D%26eqid%3Da3bb9c7500084c5f000000035c948657",target:"_blank",rel:"noopener noreferrer"}},[t._v("下载地址"),e("OutboundLink")],1)]),t._v(" "),e("li",[t._v("cuda8.0和cudnnv5.1（可选项）")])]),t._v(" "),e("blockquote",[e("p",[t._v("这里注意一下，安装工具的方法不同，用安装包最好，没有的话记得要添加环境变量")])]),t._v(" "),e("h3",{attrs:{id:"_2-编译过程"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-编译过程"}},[t._v("#")]),t._v(" 2.编译过程")]),t._v(" "),e("h4",{attrs:{id:"_2-1-利用cmake-gui-生成sln工程项目"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-利用cmake-gui-生成sln工程项目"}},[t._v("#")]),t._v(" 2.1 利用cmake-gui 生成sln工程项目")]),t._v(" "),e("ol",[e("li",[t._v("在源码的tensorflow/contrib/cmake目录下创建build文件夹以存放编译结果文件")]),t._v(" "),e("li",[t._v("打开cmake-gui，配置文件路径")]),t._v(" "),e("li",[t._v("执行cinfigure（若上述准备工具的环境变量适配好的话，这里一般没有问题，否则检查一下）")]),t._v(" "),e("li",[t._v("对tensorflow中的文件进行勾选，再执行Generate，如下图所示\n"),e("img",{attrs:{src:"https://img-blog.csdnimg.cn/20190322014016688.PNG?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MDkzNzEwMA==,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})])]),t._v(" "),e("blockquote",[e("p",[t._v("这里记录一下vs版本的问题。\n最开始我的电脑里只有vs2013和vs2017，并没有vs2015，分别用13和17两个版本尝试过，虽然网上也有相关资料，或许有成功的，但我在用13和17两个版本测试的时候，发现13可以利用cmake成功configure和generate，但后面编译sln的时候会出现很多不可描述的错误，而对17版本的测试直接挂在了generate上，所以如果有条件的话，还是用vs2015比较好，tensorflow的官方文档也明确指出了vs的版本；另外，即便使用了vs2015，也最好下载一个update3补丁，后面在编译的时候有个别错误是由于15的版本问题，使用update3可以轻松搞定。")])]),t._v(" "),e("h4",{attrs:{id:"_2-2-编译工程，生成dll和lib"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-编译工程，生成dll和lib"}},[t._v("#")]),t._v(" 2.2 编译工程，生成dll和lib")]),t._v(" "),e("ol",[e("li",[t._v("用vs2015打开build子目录下的tensorflow.sln，编译环境会对项目自动进行几秒钟的加载，然后把编译模式调整为 release 和 x64（debug模式会非常严格）然后可以开始进行编译")]),t._v(" "),e("li",[t._v("一般编译时间都会比较长，看个人配置，我这里编译一次的时间大概在2h左右")]),t._v(" "),e("li",[t._v("实践后可以看到编译结束后会根据不同的情况出现各种各样的错误（下面会对出现的常见错误进行一个整理），当我们使用各种方法解决问题后，会在build的目录下生成tensorflow.dll和tensorflow.lib文件，这就是我们的目标链接库了。\n"),e("img",{attrs:{src:"https://img-blog.csdnimg.cn/20190323201759961.PNG",alt:"在这里插入图片描述"}})])]),t._v(" "),e("h4",{attrs:{id:"_2-3-编译过程中出现的各种错误及解决方法"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-编译过程中出现的各种错误及解决方法"}},[t._v("#")]),t._v(" 2.3 编译过程中出现的各种错误及解决方法")]),t._v(" "),e("p",[t._v("网上有关c++接口的tensorflow在windows系统下的编译过程的博文和文档基本都收录在了"),e("a",{attrs:{href:"https://blog.csdn.net/weixin_40937100/article/details/88753873",target:"_blank",rel:"noopener noreferrer"}},[t._v("这篇文章里"),e("OutboundLink")],1),t._v("，解决这些问题还挺费劲的，但回过头来整理后发现，问题的种类比较集中，主要有以下几种")]),t._v(" "),e("ol",[e("li",[e("strong",[t._v("LINK : fatal error LNK1181: 无法打开输入文件“\\pywrap_tensorflow_internal.lib”")]),t._v("\n问题的解决方法是配置工程中前三个项目的附加库，具体方法是：")])]),t._v(" "),e("div",{staticClass:"language-cpp line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-cpp"}},[e("code",[t._v("修改这三个项目的配置项，\n_beam_search_ops\n_gru_ops\n_lstm_ops\n配置属性 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v(" 连接器 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v(" 常规 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v(" 附加库目录 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v("添加：\n$"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("SolutionDir"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("$"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Configuration"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br")])]),e("p",[e("img",{attrs:{src:"https://img-blog.csdnimg.cn/2019032320223372.PNG?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MDkzNzEwMA==,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})]),t._v(" "),e("ol",{attrs:{start:"2"}},[e("li",[e("p",[e("strong",[t._v("re2项目编译无法通过")])]),t._v(" "),e("p",[t._v("这个问题在"),e("a",{attrs:{href:"https://www.cnblogs.com/jliangqiu2016/p/7642471.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("这篇文章"),e("OutboundLink")],1),t._v("中提到的一种解决方法是跳过对该项目的编译过程；另一种成功的解决方法是把电脑的区域和语言改成美国和英语，在win10系统下更改设置后需要进行重新启动。修改以后这个问题得到解决，但编译时原来报错的test文件会出现乱码（其实是编码问题），无需理会。\n"),e("img",{attrs:{src:"https://img-blog.csdnimg.cn/20190323203004436.PNG?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MDkzNzEwMA==,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}}),t._v(" "),e("img",{attrs:{src:"https://img-blog.csdnimg.cn/20190323203521692.PNG?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MDkzNzEwMA==,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("error C2064: 项不会计算为接受 0 个参数的函数")])]),t._v(" "),e("p",[t._v("这种错误应该比较少，如果出现的话，解决方法是对vs2015用update3补丁更新以下。我的vs版本原本是15update3，但保险起见我还是用补丁修正了一次。\n"),e("img",{attrs:{src:"https://img-blog.csdnimg.cn/201903232032100.PNG?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MDkzNzEwMA==,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("version_info.cc not being generated on windows")])]),t._v(" "),e("p",[t._v("实际上我没有遇到这个问题，相关的解决办法详见另一篇对参考资料的整理。")])]),t._v(" "),e("li",[e("p",[e("strong",[t._v('堆内存不足error 1002 Faltal Error "compiler is out of heap space"')])]),t._v(" "),e("p",[t._v("这个问题最常见，只需要在不断解决其他错误的基础上，反复对工程进行编译，2-3次编译后这个问题就没有了。")])])]),t._v(" "),e("h4",{attrs:{id:"_2-4-其他需要注意的问题"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-其他需要注意的问题"}},[t._v("#")]),t._v(" 2.4 其他需要注意的问题")]),t._v(" "),e("ol",[e("li",[t._v("最好在编译过程中保持能访问外网")]),t._v(" "),e("li",[t._v("以管理员身份运行visual studio")]),t._v(" "),e("li",[t._v("安装cmake, git等工具的时候记得要把环境变量配置好，如果没配置好，在使用cmake-gui的时候就会弹窗报错")])]),t._v(" "),e("blockquote",[e("p",[t._v("差不多就是这些了，总结了自己最近几天以来踩过的坑，时常反省，继续探索。")])])])}),[],!1,null,null,null);s.default=r.exports}}]);